"use strict";(self.webpackChunkicjia_accessibility_docs=self.webpackChunkicjia_accessibility_docs||[]).push([[2564],{3023:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>o});var s=i(3696);const l={},t=s.createContext(l);function r(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:r(e.components),s.createElement(t.Provider,{value:n},e.children)}},4201:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>r,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"deployment/health-check-monitoring","title":"Health Check Monitoring","description":"This guide explains how to set up automated monitoring for the ICJIA Accessibility Status Portal health check endpoint.","source":"@site/docs/deployment/health-check-monitoring.md","sourceDirName":"deployment","slug":"/deployment/health-check-monitoring","permalink":"/docs/docs/deployment/health-check-monitoring","draft":false,"unlisted":false,"editUrl":"https://github.com/ICJIA/icjia-accessibility-status/tree/main/docs/docs/deployment/health-check-monitoring.md","tags":[],"version":"current","frontMatter":{}}');var l=i(2540),t=i(3023);const r={},o="Health Check Monitoring",c={},a=[{value:"Overview",id:"overview",level:2},{value:"Health Check Endpoint",id:"health-check-endpoint",level:2},{value:"Monitoring Services",id:"monitoring-services",level:2},{value:"Option 1: Uptime Robot (Recommended for Simple Monitoring)",id:"option-1-uptime-robot-recommended-for-simple-monitoring",level:3},{value:"Option 2: Datadog (Recommended for Production)",id:"option-2-datadog-recommended-for-production",level:3},{value:"Option 3: AWS CloudWatch (If Using AWS)",id:"option-3-aws-cloudwatch-if-using-aws",level:3},{value:"Option 4: Grafana + Prometheus (For Advanced Monitoring)",id:"option-4-grafana--prometheus-for-advanced-monitoring",level:3},{value:"Recommended Monitoring Strategy",id:"recommended-monitoring-strategy",level:2},{value:"For Development",id:"for-development",level:3},{value:"For Production",id:"for-production",level:3},{value:"Alert Configuration",id:"alert-configuration",level:2},{value:"Alert Thresholds",id:"alert-thresholds",level:3},{value:"Alert Channels",id:"alert-channels",level:3},{value:"Escalation Policy",id:"escalation-policy",level:3},{value:"Manual Health Check",id:"manual-health-check",level:2},{value:"Interpreting Health Check Results",id:"interpreting-health-check-results",level:2},{value:"Status: &quot;healthy&quot;",id:"status-healthy",level:3},{value:"Status: &quot;degraded&quot;",id:"status-degraded",level:3},{value:"Status: &quot;unhealthy&quot;",id:"status-unhealthy",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Health check returns 500 error",id:"health-check-returns-500-error",level:3},{value:"Health check slow (&gt; 5 seconds)",id:"health-check-slow--5-seconds",level:3},{value:"False positives (intermittent failures)",id:"false-positives-intermittent-failures",level:3},{value:"Production Deployment Checklist",id:"production-deployment-checklist",level:2},{value:"See Also",id:"see-also",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",input:"input",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"health-check-monitoring",children:"Health Check Monitoring"})}),"\n",(0,l.jsx)(n.p,{children:"This guide explains how to set up automated monitoring for the ICJIA Accessibility Status Portal health check endpoint."}),"\n",(0,l.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,l.jsxs)(n.p,{children:["The application provides a comprehensive health check endpoint at ",(0,l.jsx)(n.code,{children:"/api/health"})," that returns detailed status information about:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Backend API status"}),"\n",(0,l.jsx)(n.li,{children:"Database connectivity"}),"\n",(0,l.jsx)(n.li,{children:"All database tables"}),"\n",(0,l.jsx)(n.li,{children:"Response times"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"health-check-endpoint",children:"Health Check Endpoint"}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"URL:"})," ",(0,l.jsx)(n.code,{children:"GET /api/health"})]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Response Example:"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "status": "healthy",\n  "timestamp": "2024-11-11T12:00:00.000Z",\n  "backend": {\n    "status": "running",\n    "uptime": 3600,\n    "nodeVersion": "v20.10.0",\n    "environment": "production"\n  },\n  "database": {\n    "status": "connected",\n    "supabaseUrl": "configured",\n    "tables": {\n      "sites": { "status": "ok", "count": 42, "responseTime": 15 },\n      "sessions": { "status": "ok", "count": 5, "responseTime": 12 },\n      "admin_users": { "status": "ok", "count": 1, "responseTime": 10 },\n      "api_keys": { "status": "ok", "count": 3, "responseTime": 11 },\n      "activity_log": { "status": "ok", "count": 156, "responseTime": 18 },\n      "app_documentation": { "status": "ok", "count": 8, "responseTime": 9 },\n      "api_payloads": { "status": "ok", "count": 0, "responseTime": 8 },\n      "score_history": { "status": "ok", "count": 84, "responseTime": 14 }\n    }\n  },\n  "checks": [\n    { "name": "Backend API", "status": "ok", "responseTime": 2 },\n    { "name": "Database Connection", "status": "ok", "responseTime": 15 },\n    { "name": "All Tables", "status": "ok", "responseTime": 97 }\n  ]\n}\n'})}),"\n",(0,l.jsx)(n.h2,{id:"monitoring-services",children:"Monitoring Services"}),"\n",(0,l.jsx)(n.h3,{id:"option-1-uptime-robot-recommended-for-simple-monitoring",children:"Option 1: Uptime Robot (Recommended for Simple Monitoring)"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Free tier available"}),"\n",(0,l.jsx)(n.li,{children:"Easy setup"}),"\n",(0,l.jsx)(n.li,{children:"Email alerts"}),"\n",(0,l.jsx)(n.li,{children:"Status page"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Go to ",(0,l.jsx)(n.a,{href:"https://uptimerobot.com",children:"uptimerobot.com"})]}),"\n",(0,l.jsx)(n.li,{children:"Sign up for free account"}),"\n",(0,l.jsx)(n.li,{children:'Click "Add New Monitor"'}),"\n",(0,l.jsx)(n.li,{children:'Select "HTTP(s)" monitor type'}),"\n",(0,l.jsxs)(n.li,{children:["Enter URL: ",(0,l.jsx)(n.code,{children:"https://accessibility.icjia.app/api/health"})]}),"\n",(0,l.jsx)(n.li,{children:"Set check interval: 5 minutes"}),"\n",(0,l.jsx)(n.li,{children:"Add alert contacts (email)"}),"\n",(0,l.jsx)(n.li,{children:"Save"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Alert Configuration:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Alert when down for 5 minutes"}),"\n",(0,l.jsx)(n.li,{children:"Alert when back up"}),"\n",(0,l.jsx)(n.li,{children:"Email notifications"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"option-2-datadog-recommended-for-production",children:"Option 2: Datadog (Recommended for Production)"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Pros:"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Advanced monitoring"}),"\n",(0,l.jsx)(n.li,{children:"Custom dashboards"}),"\n",(0,l.jsx)(n.li,{children:"Detailed analytics"}),"\n",(0,l.jsx)(n.li,{children:"Integration with other services"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Sign up at ",(0,l.jsx)(n.a,{href:"https://datadoghq.com",children:"datadoghq.com"})]}),"\n",(0,l.jsx)(n.li,{children:"Go to Monitors \u2192 Synthetics"}),"\n",(0,l.jsx)(n.li,{children:"Create new API test"}),"\n",(0,l.jsxs)(n.li,{children:["Configure:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["URL: ",(0,l.jsx)(n.code,{children:"https://accessibility.icjia.app/api/health"})]}),"\n",(0,l.jsx)(n.li,{children:"Method: GET"}),"\n",(0,l.jsxs)(n.li,{children:["Assertions:","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Status code is 200"}),"\n",(0,l.jsx)(n.li,{children:'Response body contains "healthy"'}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Frequency: 5 minutes"}),"\n",(0,l.jsx)(n.li,{children:"Locations: Multiple regions"}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Set up notification channels (Slack, PagerDuty, email)"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"option-3-aws-cloudwatch-if-using-aws",children:"Option 3: AWS CloudWatch (If Using AWS)"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Go to CloudWatch \u2192 Alarms"}),"\n",(0,l.jsx)(n.li,{children:"Create new alarm"}),"\n",(0,l.jsx)(n.li,{children:'Select "Synthetic Monitoring"'}),"\n",(0,l.jsxs)(n.li,{children:["Create canary:","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"const https = require('https');\n\nconst url = 'https://accessibility.icjia.app/api/health';\n\nexports.handler = async function() {\n  return new Promise((resolve, reject) => {\n    https.get(url, (res) => {\n      if (res.statusCode === 200) {\n        resolve();\n      } else {\n        reject(new Error(`Status: ${res.statusCode}`));\n      }\n    }).on('error', reject);\n  });\n};\n"})}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Set frequency: 5 minutes"}),"\n",(0,l.jsx)(n.li,{children:"Configure SNS notifications"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"option-4-grafana--prometheus-for-advanced-monitoring",children:"Option 4: Grafana + Prometheus (For Advanced Monitoring)"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Setup:"})}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Install Prometheus on your server"}),"\n",(0,l.jsxs)(n.li,{children:["Add scrape config:","\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"scrape_configs:\n  - job_name: 'accessibility-portal'\n    static_configs:\n      - targets: ['localhost:3001']\n    metrics_path: '/api/health'\n"})}),"\n"]}),"\n",(0,l.jsx)(n.li,{children:"Install Grafana"}),"\n",(0,l.jsx)(n.li,{children:"Add Prometheus data source"}),"\n",(0,l.jsx)(n.li,{children:"Create dashboard with health check metrics"}),"\n",(0,l.jsx)(n.li,{children:"Set up alert rules"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"recommended-monitoring-strategy",children:"Recommended Monitoring Strategy"}),"\n",(0,l.jsx)(n.h3,{id:"for-development",children:"For Development"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Use Uptime Robot free tier"}),"\n",(0,l.jsx)(n.li,{children:"Check every 10 minutes"}),"\n",(0,l.jsx)(n.li,{children:"Email alerts only"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"for-production",children:"For Production"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Use Datadog or AWS CloudWatch"}),"\n",(0,l.jsx)(n.li,{children:"Check every 5 minutes"}),"\n",(0,l.jsx)(n.li,{children:"Multiple alert channels (email, Slack, PagerDuty)"}),"\n",(0,l.jsx)(n.li,{children:"Custom dashboards"}),"\n",(0,l.jsx)(n.li,{children:"Historical data retention"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"alert-configuration",children:"Alert Configuration"}),"\n",(0,l.jsx)(n.h3,{id:"alert-thresholds",children:"Alert Thresholds"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Critical:"})," Health check fails for 5+ minutes"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Warning:"})," Response time > 5 seconds"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Info:"})," Any status change"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"alert-channels",children:"Alert Channels"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Email:"})," ",(0,l.jsx)(n.a,{href:"mailto:ops@icjia.illinois.gov",children:"ops@icjia.illinois.gov"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Slack:"})," #accessibility-alerts"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"PagerDuty:"})," For on-call rotation"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"escalation-policy",children:"Escalation Policy"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"First alert: Email + Slack (5 min)"}),"\n",(0,l.jsx)(n.li,{children:"Second alert: PagerDuty (10 min)"}),"\n",(0,l.jsx)(n.li,{children:"Third alert: Phone call (15 min)"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"manual-health-check",children:"Manual Health Check"}),"\n",(0,l.jsx)(n.p,{children:"Test the health endpoint manually:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Development\ncurl http://localhost:3001/api/health\n\n# Production\ncurl https://accessibility.icjia.app/api/health\n\n# With pretty printing\ncurl https://accessibility.icjia.app/api/health | jq .\n"})}),"\n",(0,l.jsx)(n.h2,{id:"interpreting-health-check-results",children:"Interpreting Health Check Results"}),"\n",(0,l.jsx)(n.h3,{id:"status-healthy",children:'Status: "healthy"'}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"All systems operational"}),"\n",(0,l.jsx)(n.li,{children:"All database tables responding"}),"\n",(0,l.jsx)(n.li,{children:"No action needed"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"status-degraded",children:'Status: "degraded"'}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Some tables slow (response time > 1 second)"}),"\n",(0,l.jsx)(n.li,{children:"Check database performance"}),"\n",(0,l.jsx)(n.li,{children:"Review slow query logs"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"status-unhealthy",children:'Status: "unhealthy"'}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"One or more tables failing"}),"\n",(0,l.jsx)(n.li,{children:"Database connection issues"}),"\n",(0,l.jsx)(n.li,{children:"Check Supabase status"}),"\n",(0,l.jsx)(n.li,{children:"Review error logs"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,l.jsx)(n.h3,{id:"health-check-returns-500-error",children:"Health check returns 500 error"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["Check backend logs: ",(0,l.jsx)(n.code,{children:"pm2 logs icjia-accessibility-backend"})]}),"\n",(0,l.jsxs)(n.li,{children:["Verify Supabase credentials in ",(0,l.jsx)(n.code,{children:".env"})]}),"\n",(0,l.jsx)(n.li,{children:"Check database connectivity"}),"\n",(0,l.jsxs)(n.li,{children:["Restart backend: ",(0,l.jsx)(n.code,{children:"pm2 restart icjia-accessibility-backend"})]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"health-check-slow--5-seconds",children:"Health check slow (> 5 seconds)"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Check database performance"}),"\n",(0,l.jsx)(n.li,{children:"Review Supabase metrics"}),"\n",(0,l.jsx)(n.li,{children:"Check network latency"}),"\n",(0,l.jsx)(n.li,{children:"Consider adding database indexes"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"false-positives-intermittent-failures",children:"False positives (intermittent failures)"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"Increase check interval to 10 minutes"}),"\n",(0,l.jsx)(n.li,{children:"Require 2 consecutive failures before alerting"}),"\n",(0,l.jsx)(n.li,{children:"Check for temporary network issues"}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"production-deployment-checklist",children:"Production Deployment Checklist"}),"\n",(0,l.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Health check endpoint tested manually"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Monitoring service configured (Uptime Robot, Datadog, etc.)"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Alert channels configured (email, Slack, PagerDuty)"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Alert thresholds set appropriately"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Team members added to alert notifications"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Runbook created for responding to alerts"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Historical data retention configured"]}),"\n",(0,l.jsxs)(n.li,{className:"task-list-item",children:[(0,l.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Dashboard created for visibility"]}),"\n"]}),"\n",(0,l.jsx)(n.h2,{id:"see-also",children:"See Also"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/docs/deployment/laravel-forge",children:"Deployment Guide - Laravel Forge"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/docs/deployment/coolify-deployment",children:"Deployment Guide - Coolify"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/docs/docs/api/overview",children:"API Documentation"})}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}}}]);